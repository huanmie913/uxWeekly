<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>text-overflow</title>
	<link href="/wiki/static/css/demo.css" rel="stylesheet" type="text/css"/>
    <style>
        
        
        h2{font-size:14px;}
        img{ padding:2px;border:1px solid #ddd;width:47px;height:47px;}
        

        .ox{ width:500px;height:50px;border:1px solid #f00;margin:0 auto; line-height: 50px;white-space: nowrap;text-overflow:ellipsis;overflow:hidden;}


        .ox_list{ overflow:hidden;zoom:1}
        .ox_list li{float:left;margin-right:20px;display:inline;width:53px;}
        .ox_list img{}
        .ox_list a{ color:#333;text-decoration: none;display:block;}
        .ox_list span, .ox_list p{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;width:53px;display:block;}

        .nochrome{ overflow:hidden;zoom:1}
        .nochrome li{float:left;width:53px;}
        .nochrome img{display:block;}
        .nochrome a{display:block;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;color:#333;text-decoration: none;zoom:1}

        .ellipsis{ width: 100px;overflow: hidden;white-space: nowrap;-webkit-text-overflow: ellipsis;-moz-text-overflow: ellipsis;-o-text-overflow: ellipsis;
            text-overflow: ellipsis;
        }
        .text-node { border: 1px solid red;margin: 20px; }
        .check-text-length-node{  position: absolute;left: -99999em; width: auto !important; }
        .ellipsis-text{ float: right;}
    </style>
</head>
<body>
<!--toolbar-->
<div class="toolbar" id="toolbar"></div>
<!--/toolbar-->
    <!--demo_box-->
    <div class="demo_box">
       <h2>一：支持text-overflow的浏览器</h2>
       <div class="ox">其实我来截断的，截断，的其实我来截断的，截断的其实我来截断的，截断，的其实我来截断的，截断，的其实我来截断的，截断的其实我来截断的，截断，的其实我来截断的，截断，的其实我来截断的，截断的其实我来截断的，截断，的</div>
       <br/>
       <h3>1）chrome浏览器的结构:</h3>
       <ul class="ox_list">
           <li>
               <a href="#">
                   <img src="http://a.img4399.com/458140983/small" width="47" height="47"/>
               </a>
               <p>麻花疼来截断测试麻花疼来截断测试</p>
           </li>
           <li>
               <a href="#">
                   <img src="http://a.img4399.com/458140983/small" width="47" height="47"/>
                   <span>菊花也热闹菊花也热闹菊花也热闹菊花也热闹菊花也热闹</span>
               </a>
           </li>
       </ul>
       <br/>
       <h3>2）非chrome浏览器的结构</h3>
       <ul class="nochrome">
           <li>
               <a href="#">
                   <img src="http://a.img4399.com/458140983/small" width="47" height="47"/>
                   菊花也热闹菊花也热闹菊花也热闹菊花也热闹菊花也热闹
               </a>
           </li>
       </ul>
        <br/>
       <h2>二：全兼容text-overflow方案</h2>
       <div class="textooxx">
           <p style="font-weight: bold;" class="text-node ellipsis">BBBBBBBBBBBBBBBBBBBBBBBBBBBB</p>
           <p class="text-node ellipsis">111111111111111111111111111</p>
           <p class="text-node ellipsis">iiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiii</p>
           <p class="text-node ellipsis">国国国国国国国国国国国国国国国国国国国国国</p>
           <p style="font-size: 2em;" class="text-node ellipsis">qQqQqQqQqQqQqQqQqQqQqQqQqQqQqQ</p>
           <p class="text-node ellipsis">国国1111111国国qQqQq国国1111111国国国qQqQq国国1111111国国qQqQq国国国</p>
           <p style="font-size: 1.2em;color: red;" class="text-node ellipsis">ni q 国Qni q 国Qni q 国Qni q 国Qni q 国Qni q 国Qni q 国Q</p>
           <p class="text-node ellipsis">n i q 国 Qn i q 国Qni q 国 Q ni q 国 Qni q 国Q ni q 国Qni q 国Q</p>
       </div>
  </div>
 <!--/demo_box-->
   <script>
        (function(win,undefined){
            var browser = ({
               init : function(){
                   var s, ua = navigator.userAgent.toLowerCase();
                   ( s = ua.match(/msie([\d.]+)/))? this.set('ie',(s[1])):
                   ( s = ua.match(/firefox\/([\d.]+)/)) ? this.set('firefox',(s[1])):
                   ( s = ua.match(/chrome\/([\d.]+)/)) ? this.set('chrome',(s[1])) :
                   ( s = ua.match(/opera.([\d.]+)/)) ? this.set("opera",(s[1])) :
                   ( s = ua.match(/version\/([\d.]+).*safari/)) ? this.set("safari",(s[1])) : 0;
                   return this;
               },
               set : function(name,version){
                   this.name = name;
                   this.version = version;
                   this[name] = version;
               }
            }).init();
            var isSupportCss = {
                privatePrefixs : {
                    "ie" : "Ms",
                    "firefox" : "Moz",
                    "opera" : "O",
                    "chrome" : "Webkit",
                    "safari" : "Webkit"
                },
                getPrivatePrefix : function(){
                   return this.privatePrefixs[browser.name];
                },
                isSupport : function(property, checkPrivate, value){
                    var element = document.createElement('div');
                    if(property in element.style){
                        element.style[property] = value;
                        return element.style[property] === value;
                    }else if(checkPrivate){
                        var firstChar = property.charAt(0).toUpperCase();
                        property = this.getPrivatePrefix() + firstChar + property.substr(1);
                        return  this.isSupport(property,false,value);
                    }else{
                        return false;
                    }
                }
            };
            var ellipsis = function(element){
                var limitWidth = element.clientWidth;
                var ellipsisText = "...";
                var temp = element.cloneNode(true);
                temp.id = "checkTextLengthNode";
                temp.className+=" check-text-length-node";
                element.parentNode.appendChild(temp);
                var realWidth = temp.clientWidth;
                if(realWidth <= limitWidth){
                    return;
                }
                temp.innerHTML = ellipsisText;
                var elliWidth = temp.clientWidth;

                var str = element.innerHTML;
                str = str.replace(/\s+/g,' ');
                var s,totalWidth =0;
                for(var i= 0,len = str.length;i<len;i++){
                    s = str.charAt(i);
                    temp.innerHTML = ( s === ' ' ? ' ' : s );
                    totalWidth += temp.clientWidth;
                    if( totalWidth+elliWidth > limitWidth ){
                        str = str.substr(0,i);
                        break;
                    }
                }
                element.innerHTML = str + ellipsisText;
                temp.parentNode.removeChild(temp);
            }
            win.isSupportCss = isSupportCss;
            win.ellipsis = ellipsis;
        })(window);



        window.onload = function(){
            if(isSupportCss.isSupport('textOverflow', true, 'ellipsis')){
                return;
            }
            var ps = document.body.getElementsByTagName('p');
            for(var i = 0, len = ps.length; i < len; i++){
                if(ps[i].className.indexOf('ellipsis') > -1)
                    ellipsis(ps[i]);
            }
        }
   </script>
   <footer class="bottomBar" id="bottomBar"></footer>
<script src="/wiki/static/js/mod_f2er.js" type="text/javascript"></script>
<script type="text/javascript">
mod_f2er.topBar('css3--text-overflow','toolbar');
mod_f2er.bottomBar('bottomBar');
</script>
</body>
</html>