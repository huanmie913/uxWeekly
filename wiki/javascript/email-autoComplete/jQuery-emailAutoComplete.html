<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>模仿新浪注册</title>
<style type="text/css">
	*{ margin:0; padding:0}
	li{ list-style:none}
	.e_box{ width:400px; margin:20px auto; font-family:"宋体"; font-size:14px; color:#666}
	.txtInput{ padding:4px 5px; width:200px;}
	.e_tip{ border-width:0 1px 1px; border-style:solid; border-color:#ccc; background:#fff; z-index:999; position:absolute; display:none}
	.e_tip li{ color:#999; cursor:pointer; height:20px; font-size:12px; line-height:20px; padding:0 5px; margin:0 1px; white-space:nowrap; overflow:hidden}
	.e_tip li a{color:#999; text-decoration:none; display:block;}
	/*.e_tip li.on a:hover{ background:#bbb;}*/
	.e_tip li .cur_val{ background:#399; color:#000}
	
	.e_tip li.on a{ background:#F00}
	.xx{ border:1px solid #0F3}
	
</style>
<script type="text/javascript" src="js/jquery.js"></script>
</head>
<body>
<div class="e_box"><label>电子邮箱:</label><input value="e3333@126.com" class="txtInput" id="email" autocomplete="off" type="text"></div>
<!--e_tip-->
<div style="display: none; width: 212px; left: 792px; top: 46px;" class="e_tip" id="e_tip"><ul><li class="" id="e_type">请选择邮箱类型:</li><li class=""><a class="cur_val" href="javascript:void(0)">e3333</a></li><li class=""><a href="javascript:void(0)" id="e0">e3333@163.com</a></li><li class=""><a href="javascript:void(0)" id="e1">e3333@qq.com</a></li><li class="on"><a href="javascript:void(0)" id="e2">e3333@126.com</a></li><li class=""><a href="javascript:void(0)" id="e3">e3333@hotmail.com</a></li><li class=""><a href="javascript:void(0)" id="e4">e3333@gmail.com</a></li><li class=""><a href="javascript:void(0)" id="e5">e3333@sohu.com</a></li><li class=""><a href="javascript:void(0)" id="e6">e3333@yahoo.com.cn</a></li><li class=""><a href="javascript:void(0)" id="e7">e3333@yahoo.com</a></li><li class=""><a href="javascript:void(0)" id="e8">e3333@sina.com</a></li><li class=""><a href="javascript:void(0)" id="e9">e3333@msn.com</a></li></ul></div>
<!--/e_tip-->
<script type="text/javascript">
 var suffixArr=new Array("@163.com", "@qq.com", "@126.com", "@hotmail.com", "@gmail.com", "@sohu.com", "@yahoo.com.cn", "@yahoo.com", "@sina.com", "@msn.com");
	(function(){
		$.fn.autoComplete=function(arg){
			var opt={
				subBox:"#e_tip",/*提示框ID*/
				subOp:"li",/*操作对象*/
				id:"#email",/*文本框ID*/
				suffixArr:suffixArr,//数组对象
				hoverClass:"on"/*选中效果*/
			};
		  
		   var option=$.extend(opt,arg);
		   var _oLeft=$(option.id).offset().left,
		   		_oTop=$(option.id).offset().top,
				_oWidth=$(option.id).outerWidth(),
				_oHeight=$(option.id).outerHeight();
		   var _cur=1;
			
		   $(option.id).keyup(function(e){
						if(e.keyCode==40 || e.keyCode==38){
							return false;
						}
						var _that=$(this);
						if(_that.val()!=""){
								if(e.keyCode!=38 && e.keyCode!=40 && e.keyCode!=13 && e.keyCode!=27){
									var _inputVal=_that.val();
									$.fn.autoComplete.tipFun(_inputVal,_that);
								}
						}else{
							$(option.subBox).hide()	
						}
				 });
		   
		   //tipFun函数
		   $.fn.autoComplete.tipFun=function(_v,o){
			   var _that=o;
			   $(option.subBox).css({"width":_oWidth,"left":_oLeft,"top":_oTop+_oHeight,"display":"block"})
			   var str="<ul>";
		       str += '<li id="e_type">请选择邮箱类型:</li><li><a class="cur_val" href="javascript:void(0)" >' + _v + "</a></li>";
			   var e=_v.indexOf("@");
			   if(e==-1){
						  $.each(option.suffixArr,function(s,m){
						  str+='<li><a href="javascript:void(0)"  id="e'+s+'">' + _v + m + "</a></li>"							
				      })
				}else {
						 var _sh=_v.substring(0,e)
						 var _se=_v.substring(e);
						 $.each(option.suffixArr, function (s,m) {
							if(m.indexOf(_se)!=-1){
									str += '<li><a href="javascript:void(0)" id="e'+s+'" >' + _sh + m + "</a></li>"	
							}
					})
				}
				str+="</ul>";
				$(option.subBox).html(str); 
			    
				 /*绑定hover事件*/
					$(option.subBox).find(option.subOp).hover(function(){
							var _that=$(this);
							_that.addClass(option.hoverClass)					   
						},function(){
							var _that=$(this);
							_that.removeClass(option.hoverClass)			
						});
					/*绑定click事件*/
					$(option.subBox).find(option.subOp).each(function(){
						$(this).click(function(e){
							if($(e.target).attr("id")!="e_type"){
								$(option.id).val($(e.target).html());
								$(option.subBox).hide();
								e.stopPropagation();
							}
						});											  
					})
			};
			/*点击页面其他地方关闭提示层*/
			$(document).bind("click",function(e){
				 	$(option.subBox).hide();
			});
			
			/*itemFun*/
			$.fn.autoComplete.itemFun=function(){
				var _tempArr=$(option.subBox).find(option.subOp)
				var _size=_tempArr.size();
					for(var i=0;i<_size;i++){
						_tempArr.eq(i).removeClass(option.hoverClass)
					}
					if(_size>2){
						if(_cur>_size-1){
							_cur=2;	
						}
						if(_cur<2){
							_cur=_size-1;	
						}
						_tempArr.eq(_cur).addClass(option.hoverClass);
					}else{
						_cur=1;	
					}
			};
			
			$(document).keydown(function(e){
					switch(e.keyCode){
						  case 40://下键
							   _cur++;
							   $.fn.autoComplete.itemFun()
							   break;
						  case 38://上键
							   _cur--;
							   $.fn.autoComplete.itemFun()
							   break;
						  default:
							   break;
					}
			})
		/*文本框keydown*/
		$(option.id).keydown(function(e){
			var _temp=$(option.subBox).find(option.subOp);
			if(e.keyCode==13){
				$(this).val(_temp.eq(_cur).text());
				$(option.subBox).hide();
				e.stopPropagation();
				_cur=1;
			}							  
		});
		return this;	
	}		  
})(jQuery);
	/*执行*/
	$("#email").autoComplete()
</script>


</body></html>